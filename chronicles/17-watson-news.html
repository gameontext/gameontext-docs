<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><link rel=stylesheet href=https://use.fontawesome.com/e3112f1bdf.css><link rel=stylesheet href=/css/flex.min.62d46290de4e8cb4b407a0a4c54711bb69af2f268ce654c5af64efa38732d394.css><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><title>GO: Making a Watson Alchemy Data News Room</title><link rel=canonical href=/chronicles/17-watson-news.html><link rel=alternate type=application/rss+xml href=/blog/index.xml title="Game On! Adventures with microservices"></head><body><header class=head-single><h1><a href=/>GAME<span class=on>ON</span></a></h1><div>Hands-on experiment building microservices and cloud native applications</div></header><nav class=project><a target=_blank href=https://gameontext.org title="Play the game"><i class="fa fa-play" aria-hidden=true></i><span>Play <span>the game</span></span></a>
<a href=/about/ title="Read the book"><i class="fa fa-book" aria-hidden=true></i><span>Learn <span>more</span></span></a>
<a href=/blog/ title="Read the blog"><i class="fa fa-newspaper-o" aria-hidden=true></i><span>Read <span>our blog</span></span></a>
<a target=_blank href=https://gameontext.org/slackin/ title="Join our slack team"><i class="fa fa-slack" aria-hidden=true></i><span><span>Join us on</span> Slack</span></a>
<a target=_blank class=github href=https://github.com/gameontext title="View project on GitHub"><i class="fa fa-github" aria-hidden=true></i><span>Github</span></a></nav><main class="book page"><article><header><h1>Making a Watson Alchemy Data News Room</h1></header><p>This entry in the Chronicles will seem more like deleted scenes from a movie when compared to what has been chronicled so far.</p><p>The room I wanted to create was a Watson Alchemy Data API News Room. The details and the code can be found <a href=http://github.com/bradleyap/Watson-news-sample-room-java>on github</a></p><p>Among other things, what slowed me down a tad bit was trying to look at why a simple string edit to initial values of the room description would cause the tests to fail. Tests are sometimes written in a preliminary fashion and in projects like GameOn!, oriented toward learning. Perhaps they are written just to demo having them, not so much demoing how to write them? Here was my quick fix: <code>mvn install -DskipTests</code> Yep, I took the path of least resistance.</p><p>I learned that an API like Watson Alchemy Data is very complex. Many of my coding errors related to an inadequate grasp of the queries that are accepted by this API even though I had a <a href=http://querybuilder.alchemyapi.com/builder>very helpful tool to learn with. http://querybuilder.alchemyapi.com/builder</a>. <a href=http://querybuilder.alchemyapi.com/builder>This site</a> allows you to check boxes for what type of query you want, display the query that is built and shows the JSON data you have retrieved. Quite nice! The JSON you get back is straight-forward but it&#8217;s very easy to make mistakes when you transcribe and/or embed the pattern into code that accesses it.</p><p>Some final observations, I was given an allowed number of "transactions" with my free Watson Alchemy API service account. 1000 transactions per day for the 'Free Plan' with other limitations described in the <a href=http://console.ng.bluemix.net/catalog>Bluemix catalog</a>. So as soon as I exceeded this daily number of transactions the service quit working. After a little digging I got a better picture of what this 'Free Plan' allows me to do.</p><p>Lessons learned&#8230;&#8203;</p><p>1) Understand that for Alchemy Data API calls, "transactions" are a calculuated number based on the number of "enriched" items returned, and their volume and the timeframe specified by your query. This is documented in the <a href=http://www-03.ibm.com/software/sla/sladb.nsf/pdf/0012-04/$file/i128-0012-04_06-2016_en_US.pdf>Service Description for Alchemy API for Bluemix</a></p><p>Additionally, it is rumored that for each call to the API there is a constant cost component of 2 transactions. So the calculation is stated in a more specific way (by Bluemix level 1 help):</p><div class=listing-block><pre>        transactions = (number_of_returns * count) + 2</pre></div><p>2) Request specific information. Instead of having a "return=enriched.url" argument in the query, retreive the more specific data with "return=enriched.url.title" or with "return=enriched.url.title,enriched.url.url"</p><p>3) Look at sample queries that the <a href=http://querybuilder.alchemyapi.com/builder>Alchemy API demo</a> to learn how to formulate different kinds of queries without using your own apiKey.</p><p>4) Lower the count to 1 in your query when you need to experiment see possible data items that <strong>can</strong> be returned, or better yet, use the Demo app above. I&#8217;ve been able to confirm that the "enriched.url" data has the following sub-elements: "author, cleanedTitle, concepts, docSentiment, entities, relations, feeds, image, keywords, imageKeywords, language, publicationDate, relations, taxonomy, text, title, url. Most of these will use up your daily limit quickly even with a count of 1, except for author,cleanedTitle,docSentiment,title and url. For example, using "count=1", I burned 784 transactions by fetching each of these with "return=enriched.url". ("enriched.url" is the site and it&#8217;s contents, "enriched.url.url" is the site address").</p><p>5) Reduce the count to less than 10 for more specific queries.</p><p>6) A paid plan might be needed if you want to make the Watson News service available to all visitors to a GameOn! room. However, this depends on what information you want Watson to provide. For each API call that restricts the number of results shown to 10 and the number of returns to only 2 abbreviated items (url and title), the cost is not 22 transactions. To give you an idea of how much things cost, I&#8217;ll gradually change parts of the Demo URL. But remember, the more you remove, the more like a plain keyword search your query becomes and the less you exploit the Alchemy API&#8217;s human like intelligence&#8230;&#8203;.</p><p>The following query costs 814 transactions. That&#8217;s more than half of the daily limit and no text is returned.
Any changes will show a gradual reduction in transaction cost and it also shows reduced exploitation of service capabilities:</p><div class=listing-block><pre>        https://gateway-a.watsonplatform.net/calls/data/GetNews?apikey=&lt;your_key_here&gt;&amp;return=enriched.url.title,enriched.url.url&amp;start=1484611200&amp;end=1485298800&amp;q.enriched.url.enrichedTitle.entities.entity=|text=IBM,type=company|&amp;q.enriched.url.enrichedTitle.docSentiment.type=positive&amp;q.enriched.url.enrichedTitle.taxonomy.taxonomy_.label=technology%20and%20computing&amp;count=25&amp;outputMode=json</pre></div><p>Here I will show how the cost changes. You will see a gradual reduction in transaction cost along with reduced exploitation of service capabilities when parts of the query are removed:</p><div class=table-block><table class="frame-all grid-all spread"><col style=width:50%><col style=width:50%><thead><tr><th class="halign-left valign-top">change</th><th class="halign-left valign-top">transactions used</th></tr><tbody><tr><td class="halign-left valign-top">no changes</td><td class="halign-left valign-top">814</td></tr><tr><td class="halign-left valign-top">count=10</td><td class="halign-left valign-top">784</td></tr><tr><td class="halign-left valign-top">count=1 and remvoed q.enriched.url.enrichedTitle.taxonomy.taxonomy_.label=technology%20and%20computing</td><td class="halign-left valign-top">575</td></tr><tr><td class="halign-left valign-top">removed q.enriched.url.enrichedTitle.docSentiment.type=positive</td><td class="halign-left valign-top">384</td></tr><tr><td class="halign-left valign-top">changed to acces.alchemyapi URL</td><td class="halign-left valign-top">384</td></tr><tr><td class="halign-left valign-top">changed to start now end now</td><td class="halign-left valign-top">50</td></tr></table></div><p>7) You can see the number of transactions used for the current day by visiting here:</p><div class=listing-block><pre>        http://access.alchemyapi.com/calls/info/GetAPIKeyInfo?apikey=&lt;api_key&gt;</pre></div></article><nav class=prev-next><div class=nav-left><div class=long><a href=/chronicles/16-caching.html title="Previous: Marco? Polo, Polo, Polo, Polo. (Caching).">Marco? Polo, Polo, Polo, Polo. (Caching).</a></div><div class=short><a href=/chronicles/16-caching.html title="Previous: Marco? Polo, Polo, Polo, Polo. (Caching).">Previous</a></div></div><div class=nav-center><div class=long>Up: <a href=/chronicles/>Appendix: The Chronicles</a></div><div class=short><a href=/chronicles/>Up</a></div></div><div class=nav-right><div class=long><a href=/chronicles/18-weather-room.html title="Next: Weather Room (Interacting with REST API service)">Weather Room (Interacting with REST API service)</a></div><div class=short><a href=/chronicles/18-weather-room.html title="Next: Weather Room (Interacting with REST API service)">Next</a></div></div></nav></main><footer class=foot><div id=copyrights>&#169; 2016-2020 under terms of the Apache License 2.0.</div><div>Follow us:
<a target=_blank href=https://twitter.com/gameontext title="Follow @gameontext"><i class="fa fa-twitter" aria-hidden=true></i></a></div></footer><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-90113653-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>